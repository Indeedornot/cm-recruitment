<?phpuse App\Security\Event\UserEvent;use App\Security\EventListener\UserEventListener;use App\Tests\Services\MockUserFactory;use Symfony\Component\Mailer\MailerInterface;use Symfony\Component\Mime\Email;class TestDTO{    public function __construct(        public MockUserFactory $userFactory,    ) {    }}describe('test user mails', function () {    $test = new TestDTO(new MockUserFactory());    test('should send an email about created account to user', function () use ($test) {        $user = $test->userFactory->createAdmin();        $mailer = Mockery::mock(MailerInterface::class);        $mailer            ->shouldReceive('send')            ->withArgs(function (Email $email) use ($user) {                $mails = array_map(fn($to) => $to->getAddress(), $email->getTo());                return in_array($user->getEmail(), $mails);            })            ->once();        (new UserEventListener($mailer))->onPreUserCreated(new UserEvent($user));    });});